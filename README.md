# 视觉计算辅助良品检测

- 参赛地址：[雪浪制造AI挑战赛](https://tianchi.aliyun.com/competition/introduction.htm?spm=a2c22.11695015.1131732.1.4ea25275NNvZuf&raceId=231666) 


----------

# YOLOhasst


  - ##  You Only Look One hundred and sixty-six times



 ###### 注： [训练好的模型]()


# 前言
本项目由我和团队成员黄杰、吴宏和 三人共同完成；




# 训练心得
1.我们结合了2种不同的方法，分别是切割和resize：
2.对于切割方法：我们将整张图切成320*320的大小，总共11*15=165张，并对每个切割的图片进行判断其中是否包含瑕疵，并且要求包含的瑕疵面积占完整瑕疵面积的比例大于0.09才认为其属于瑕疵，若完全没包含瑕疵，则为正常图片，剩下瑕疵比例较少的丢弃。直接用该方法线上测试结果为0.88。
3.除了这种切割瑕疵方法外我们也测试了在瑕疵附近随机切割的方法，发现训练结果差别不大。
4.和其他切割方法不同的点是我们对预测方法进行了改进：
    1）测试时我们把测试图片按步长160进行切割（即相邻的切割图片有一半的区域重叠）
    2）测试时我们并不是取所有切割图片中最大的概率，而是改进取前三的概率平均
5.经过以上两个方法改进，线上测试结果能提高到0.91和0.93左右。
6.对于resize方法：我们直接将图片reszie到600*800大小，直接进行训练，测试结果大概为0.91左右
7.最后综合2种模型，预测结果取0.5*pA+0.5*pB, 最终测试结果能到0.95以上。



# 使用步骤：

1.首先将初赛官方的测试图片解压放到data\official文件夹中。

2.将初赛的2次测试图片和公布的答案解压放在test\testa和test\testb文件夹中。

3.打开main.ipynb，依次运行每一个cell即可，程序会自动保存模型，最后会计算testa和testb中的auc


# 注意事项：

1.程序运行过程中会生成训练所需的cut和resize图片并保存在data目录下的对应文件夹中，若第一次运行后已生成图片，第二次运行可跳过cell2-4，直接从Train Model A开始；或者删除生成的中间文件夹，仅保留data\official文件夹，然后重头运行，避免重复保存中间图片。

